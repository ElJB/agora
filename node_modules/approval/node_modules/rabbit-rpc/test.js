var Rpc = require('./client.js'),
	RpcServer = require('./server.js'),
	assert = require('assert');

var multiply = new Rpc('multiply'),
	server = new RpcServer('multiply', function(args){
		return args.reduce(function(a, b){
			return a * b;
		});
	});

multiply.once("connected", function(){
	multiply.call([4, 5])
		.then(function(result){
			assert.equal(result, 20);
			console.log("rabbit-rpc test: OK")
		})
		.catch(function(err){
			console.log(err.stack);
		});
});
